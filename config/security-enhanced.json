{
  "security": {
    "rateLimit": {
      "enabled": true,
      "window": 60000,
      "maxRequests": {
        "default": 100,
        "auth": 10,
        "share": 1000,
        "api": 50,
        "websocket": 10,
        "admin": 20,
        "export": 5
      },
      "skipSuccessfulRequests": false,
      "keyGenerator": "ip",
      "blockDuration": 900000
    },
    "session": {
      "timeout": 86400000,
      "renewBeforeExpiry": 3600000,
      "maxConcurrent": 5,
      "secure": true,
      "httpOnly": true,
      "sameSite": "strict"
    },
    "password": {
      "minLength": 12,
      "requireUppercase": true,
      "requireLowercase": true,
      "requireNumbers": true,
      "requireSpecial": true,
      "maxAttempts": 3,
      "lockoutDuration": 1800000,
      "historyCount": 5,
      "expiryDays": 90
    },
    "twoFactor": {
      "enabled": true,
      "windowSize": 1,
      "backupCodes": 10,
      "enforceForAdmins": true,
      "gracePeriodDays": 7
    },
    "api": {
      "keyLength": 32,
      "maxKeysPerUser": 3,
      "defaultExpiry": 2592000000,
      "keyRotationDays": 30,
      "requireHttps": true
    },
    "cors": {
      "enabled": true,
      "origins": [
        "https://otedama.io",
        "https://app.otedama.io",
        "https://admin.otedama.io"
      ],
      "methods": ["GET", "POST", "PUT", "DELETE", "OPTIONS"],
      "headers": ["Content-Type", "Authorization", "X-Request-ID"],
      "credentials": true,
      "maxAge": 86400
    },
    "headers": {
      "hsts": {
        "enabled": true,
        "maxAge": 63072000,
        "includeSubDomains": true,
        "preload": true
      },
      "csp": {
        "enabled": true,
        "reportOnly": false,
        "reportUri": "/api/csp-report",
        "directives": {
          "defaultSrc": ["'self'"],
          "scriptSrc": ["'self'", "'nonce-{NONCE}'"],
          "styleSrc": ["'self'", "'nonce-{NONCE}'"],
          "imgSrc": ["'self'", "data:", "https:"],
          "connectSrc": ["'self'", "wss://otedama.io", "https://api.otedama.io"],
          "fontSrc": ["'self'"],
          "objectSrc": ["'none'"],
          "mediaSrc": ["'none'"],
          "frameSrc": ["'none'"],
          "baseUri": ["'self'"],
          "formAction": ["'self'"],
          "frameAncestors": ["'none'"],
          "upgradeInsecureRequests": true
        }
      },
      "additional": {
        "X-Content-Type-Options": "nosniff",
        "X-Frame-Options": "DENY",
        "X-XSS-Protection": "1; mode=block",
        "Referrer-Policy": "strict-origin-when-cross-origin",
        "Permissions-Policy": "geolocation=(), microphone=(), camera=()"
      }
    },
    "encryption": {
      "algorithm": "aes-256-gcm",
      "keyDerivation": "argon2id",
      "saltLength": 32,
      "tagLength": 16,
      "iterations": 3,
      "memory": 65536,
      "parallelism": 4
    },
    "audit": {
      "enabled": true,
      "retentionDays": 180,
      "logLevel": "info",
      "includeRequestBody": false,
      "includeResponseBody": false,
      "sensitiveActions": [
        "auth",
        "payout",
        "api_key_create",
        "settings_change",
        "admin_action",
        "wallet_update",
        "security_update"
      ],
      "piiFields": ["password", "email", "wallet", "privateKey", "seed"]
    },
    "inputValidation": {
      "enabled": true,
      "maxRequestSize": "10mb",
      "maxFieldSize": "1mb",
      "rejectUnknownFields": true,
      "sanitizeHtml": true
    },
    "secrets": {
      "rotationDays": 90,
      "vaultEnabled": false,
      "keyManagementService": "local"
    }
  },
  "performance": {
    "database": {
      "poolMin": 5,
      "poolMax": 20,
      "idleTimeout": 30000,
      "acquireTimeout": 5000,
      "connectionRetries": 3,
      "statementTimeout": 30000,
      "queryLogging": false
    },
    "cache": {
      "enabled": true,
      "type": "memory",
      "maxSize": 1000,
      "ttl": 300000,
      "checkInterval": 60000,
      "updateAgeOnGet": true,
      "cloneValues": true
    },
    "workers": {
      "poolMin": 4,
      "poolMax": 16,
      "idleTimeout": 60000,
      "taskTimeout": 30000,
      "maxTaskRetries": 3
    },
    "compression": {
      "enabled": true,
      "level": 6,
      "threshold": 1024,
      "types": ["text/html", "text/css", "text/javascript", "application/json"]
    },
    "batching": {
      "enabled": true,
      "maxBatchSize": 100,
      "maxWaitTime": 10,
      "concurrency": 5
    }
  },
  "monitoring": {
    "metrics": {
      "enabled": true,
      "interval": 30000,
      "retention": 604800000,
      "aggregationInterval": 300000
    },
    "alerts": {
      "enabled": true,
      "channels": ["console", "file", "webhook"],
      "webhookUrl": null,
      "cooldownPeriod": 300000,
      "thresholds": {
        "errorRate": 0.01,
        "responseTime": 500,
        "cpuUsage": 0.75,
        "memoryUsage": 0.85,
        "diskUsage": 0.90,
        "failedLogins": 10,
        "suspiciousActivity": 5
      }
    },
    "healthCheck": {
      "enabled": true,
      "interval": 30000,
      "timeout": 5000,
      "gracePeriod": 60000,
      "checks": {
        "database": true,
        "cache": true,
        "blockchain": true,
        "diskSpace": true,
        "memory": true
      },
      "endpoints": [
        "/health",
        "/api/stats",
        "/metrics"
      ]
    },
    "logging": {
      "level": "info",
      "format": "json",
      "timestampFormat": "ISO",
      "maxFiles": 30,
      "maxFileSize": "100m",
      "compression": true,
      "sensitiveDataMasking": true
    }
  }
}